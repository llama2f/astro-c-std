---
import { getCollection } from 'astro:content';
import BaseLayout from '@/layouts/BaseLayout.astro';
import BlogPost from '@components/BlogPost.astro';
import Tags from '@components/Tags.astro';
import PageNavi from '@components/PageNavi.astro'


//ページ分割生成
export async function getStaticPaths({ paginate }) {
  const pages = await getCollection('blog', ({ data }) => {
  return data.isDraft !== true;
});
  return paginate(pages, { pageSize: 15 });
}

//全記事数
const allblogPosts =await getCollection('blog', ({ data }) => {
  return data.isDraft !== true;
});
const allpagenum = Object.keys(allblogPosts).length

// All paginated data is passed on the "page" prop
const { page } = Astro.props;

---

<BaseLayout pageTitle=`BlogList ${page.currentPage}` desc='ブログ一覧です'>
  <ul class="pl-0">
    {page.data.map((post) => 
        <BlogPost url={post.slug} title={post.data.title} tags={post.data.tags} pubDate={post.data.pubDate} />    
    )}
  </ul>

  <PageNavi cur_page={page.currentPage} max_page={page.lastPage} base_url="blog" />


    <Tags />
</BaseLayout>